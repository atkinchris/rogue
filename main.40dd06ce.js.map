{"version":3,"sources":["webpack:///main.40dd06ce.js","webpack:///webpack/bootstrap 40dd06ce7d7a9b6551c6","webpack:///./node_modules/uuid/lib/rng-browser.js","webpack:///./node_modules/uuid/lib/bytesToUuid.js","webpack:///./src/index.js","webpack:///./src/utils/store.js","webpack:///./node_modules/uuid/index.js","webpack:///./node_modules/uuid/v1.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/uuid/v4.js","webpack:///./src/systems/index.js","webpack:///./src/systems/render.js","webpack:///./src/systems/playerControl.js","webpack:///./src/systems/applyMovement.js","webpack:///./src/systems/evaluateMovement.js","webpack:///./src/systems/collision.js","webpack:///./src/systems/cacheCollisions.js","webpack:///./src/utils/loop.js","webpack:///./src/utils/inputHandler.js","webpack:///./src/assemblages/map.js","webpack:///./src/assemblages/index.js","webpack:///./src/utils/onScreenControls.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","default","object","property","prototype","hasOwnProperty","p","s","global","rng","crypto","msCrypto","getRandomValues","rnds8","Uint8Array","rnds","Array","r","Math","random","bytesToUuid","buf","offset","bth","byteToHex","toString","substr","_interopRequireDefault","obj","_store","_store2","_systems","_systems2","_loop","_loop2","_inputHandler","_inputHandler2","_map","_map2","_onScreenControls","_onScreenControls2","store","direction","setCache","type","_classCallCheck","instance","Constructor","TypeError","value","_createClass","defineProperties","target","props","length","descriptor","writable","key","protoProps","staticProps","_uuid","Store","this","entities","components","caches","id","v4","cache","entity","component","state","arguments","_this","keys","filter","every","getComponent","console","log","v1","uuid","options","b","clockseq","_clockseq","msecs","Date","getTime","nsecs","_lastNSecs","dt","_lastMSecs","Error","tl","tmh","node","_nodeId","_seedBytes","g","Function","eval","e","window","ii","_render","_render2","_playerControl","_playerControl2","_applyMovement","_applyMovement2","_evaluateMovement","_evaluateMovement2","_collision","_collision2","_cacheCollisions","_cacheCollisions2","renderSystem","canvas","document","getElementById","context","getContext","layers","width","height","getEntitiesWith","clearRect","forEach","layer","tile","position","x","y","_tile$layer","cloneNode","ctx","fillStyle","fillRect","font","fillText","character","restore","drawImage","playerControlSystem","breakLoop","intent","getCache","addComponent","applyMovementSystem","removeComponent","evaluateMovementSystem","_store$getComponent","result","collisionSystem","collisionMap","_defineProperty","_extends","assign","source","cacheCollisions","reduce","map","runLoop","systems","loop","iteration","message","warn","system","createInputHandler","callback","handler","event","repeat","code","addEventListener","removeEventListener","_","MAP","buildMap","row","split","cell","createPlayer","createFloor","createWall","createEntity","KEYS","up","down","left","right","dispatchKey","Event","dispatchEvent","buildControls"],"mappings":"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","file":"main.40dd06ce.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 2);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(global) {// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\nvar rng;\n\nvar crypto = global.crypto || global.msCrypto; // for IE 11\nif (crypto && crypto.getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n  rng = function whatwgRNG() {\n    crypto.getRandomValues(rnds8);\n    return rnds8;\n  };\n}\n\nif (!rng) {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n  rng = function() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n\nmodule.exports = rng;\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(6)))\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  return bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]];\n}\n\nmodule.exports = bytesToUuid;\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _store = __webpack_require__(3);\n\nvar _store2 = _interopRequireDefault(_store);\n\nvar _systems = __webpack_require__(8);\n\nvar _systems2 = _interopRequireDefault(_systems);\n\nvar _loop = __webpack_require__(15);\n\nvar _loop2 = _interopRequireDefault(_loop);\n\nvar _inputHandler = __webpack_require__(16);\n\nvar _inputHandler2 = _interopRequireDefault(_inputHandler);\n\nvar _map = __webpack_require__(17);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _onScreenControls = __webpack_require__(19);\n\nvar _onScreenControls2 = _interopRequireDefault(_onScreenControls);\n\n__webpack_require__(20);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar store = new _store2.default();\n\n(0, _inputHandler2.default)(function (direction) {\n  store.setCache('playerIntent', { type: 'move', direction: direction });\n  (0, _loop2.default)(store, _systems2.default);\n});\n\n(0, _map2.default)(store);\n(0, _loop2.default)(store, _systems2.default);\n\n(0, _onScreenControls2.default)();\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _uuid = __webpack_require__(4);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Store = function () {\n  function Store() {\n    _classCallCheck(this, Store);\n\n    this.entities = {};\n    this.components = {};\n    this.caches = {};\n  }\n\n  _createClass(Store, [{\n    key: 'createEntity',\n    value: function createEntity() {\n      var id = (0, _uuid.v4)();\n      this.entities[id] = true;\n\n      return id;\n    }\n  }, {\n    key: 'setCache',\n    value: function setCache(key, cache) {\n      this.caches[key] = cache;\n    }\n  }, {\n    key: 'getCache',\n    value: function getCache(key) {\n      return this.caches[key];\n    }\n  }, {\n    key: 'addComponent',\n    value: function addComponent(entity, component) {\n      var state = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n      if (!this.components[component]) {\n        this.components[component] = {};\n      }\n\n      this.components[component][entity] = state;\n    }\n  }, {\n    key: 'removeComponent',\n    value: function removeComponent(entity, component) {\n      if (!this.components[component]) {\n        this.components[component] = {};\n      }\n\n      this.components[component][entity] = null;\n    }\n  }, {\n    key: 'getEntitiesWith',\n    value: function getEntitiesWith(components) {\n      var _this = this;\n\n      var allEntities = Object.keys(this.entities);\n\n      return allEntities.filter(function (entity) {\n        return components.every(function (component) {\n          return _this.getComponent(entity, component);\n        });\n      });\n    }\n  }, {\n    key: 'getComponent',\n    value: function getComponent(entity, component) {\n      return this.components[component] && this.components[component][entity];\n    }\n  }, {\n    key: 'debugComponents',\n    value: function debugComponents() {\n      console.log(this.components);\n    }\n  }]);\n\n  return Store;\n}();\n\nexports.default = Store;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar v1 = __webpack_require__(5);\nvar v4 = __webpack_require__(7);\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar rng = __webpack_require__(0);\nvar bytesToUuid = __webpack_require__(1);\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\n// random #'s we need to init node and clockseq\nvar _seedBytes = rng();\n\n// Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\nvar _nodeId = [\n  _seedBytes[0] | 0x01,\n  _seedBytes[1], _seedBytes[2], _seedBytes[3], _seedBytes[4], _seedBytes[5]\n];\n\n// Per 4.2.2, randomize (14 bit) clockseq\nvar _clockseq = (_seedBytes[6] << 8 | _seedBytes[7]) & 0x3fff;\n\n// Previous uuid creation time\nvar _lastMSecs = 0, _lastNSecs = 0;\n\n// See https://github.com/broofa/node-uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  var node = options.node || _nodeId;\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports) {\n\nvar g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\n} catch(e) {\n\t// This works if the window reference is available\n\tif(typeof window === \"object\")\n\t\tg = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar rng = __webpack_require__(0);\nvar bytesToUuid = __webpack_require__(1);\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options == 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _render = __webpack_require__(9);\n\nvar _render2 = _interopRequireDefault(_render);\n\nvar _playerControl = __webpack_require__(10);\n\nvar _playerControl2 = _interopRequireDefault(_playerControl);\n\nvar _applyMovement = __webpack_require__(11);\n\nvar _applyMovement2 = _interopRequireDefault(_applyMovement);\n\nvar _evaluateMovement = __webpack_require__(12);\n\nvar _evaluateMovement2 = _interopRequireDefault(_evaluateMovement);\n\nvar _collision = __webpack_require__(13);\n\nvar _collision2 = _interopRequireDefault(_collision);\n\nvar _cacheCollisions = __webpack_require__(14);\n\nvar _cacheCollisions2 = _interopRequireDefault(_cacheCollisions);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = [(0, _cacheCollisions2.default)(), (0, _playerControl2.default)(), (0, _evaluateMovement2.default)(), (0, _collision2.default)(), (0, _applyMovement2.default)(), (0, _render2.default)()];\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar TILE_SIZE = 20;\n\nvar renderSystem = function renderSystem() {\n  var canvas = document.getElementById('canvas');\n  var context = canvas.getContext('2d');\n  var layers = [];\n\n  canvas.width = 10 * TILE_SIZE;\n  canvas.height = 10 * TILE_SIZE;\n\n  return function (store) {\n    var entities = store.getEntitiesWith(['tile', 'position']);\n    context.clearRect(0, 0, canvas.width, canvas.height);\n    layers.forEach(function (layer) {\n      layer.getContext('2d').clearRect(0, 0, canvas.width, canvas.height);\n    });\n\n    entities.forEach(function (entity) {\n      var tile = store.getComponent(entity, 'tile');\n      var position = store.getComponent(entity, 'position');\n      var x = position.x * TILE_SIZE;\n      var y = position.y * TILE_SIZE;\n      var _tile$layer = tile.layer,\n          layer = _tile$layer === undefined ? 0 : _tile$layer;\n\n\n      if (!layers[layer]) {\n        layers[layer] = canvas.cloneNode();\n      }\n\n      var ctx = layers[layer].getContext('2d');\n\n      ctx.fillStyle = 'black';\n      ctx.fillRect(x, y, TILE_SIZE, TILE_SIZE);\n\n      ctx.font = '20px monospace';\n      ctx.fillStyle = 'white';\n      ctx.fillText(tile.character, x, y + TILE_SIZE);\n\n      ctx.restore();\n    });\n\n    layers.forEach(function (layer) {\n      context.drawImage(layer, 0, 0);\n    });\n  };\n};\n\nexports.default = renderSystem;\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar playerControlSystem = function playerControlSystem() {\n  return function (store, breakLoop) {\n    var intent = store.getCache('playerIntent');\n\n    if (intent && intent.type) {\n      var entities = store.getEntitiesWith(['playerControlled']);\n\n      entities.forEach(function (entity) {\n        switch (intent.type) {\n          case 'move':\n            store.addComponent(entity, 'moveIntent', intent);\n            break;\n          default:\n            breakLoop('Invalid intent from ', entity);\n            break;\n        }\n      });\n    } else {\n      breakLoop('No intent found');\n    }\n\n    store.setCache('playerIntent', null);\n  };\n};\n\nexports.default = playerControlSystem;\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar applyMovementSystem = function applyMovementSystem() {\n  return function (store) {\n    var entities = store.getEntitiesWith(['moveIntent', 'position']);\n\n    entities.forEach(function (entity) {\n      var intent = store.getComponent(entity, 'moveIntent');\n\n      store.addComponent(entity, 'position', intent);\n      store.removeComponent(entity, 'moveIntent');\n    });\n  };\n};\n\nexports.default = applyMovementSystem;\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar evaluateMovementSystem = function evaluateMovementSystem() {\n  return function (store, breakLoop) {\n    var entities = store.getEntitiesWith(['moveIntent', 'position']);\n\n    entities.forEach(function (entity) {\n      var intent = store.getComponent(entity, 'moveIntent');\n\n      var _store$getComponent = store.getComponent(entity, 'position'),\n          x = _store$getComponent.x,\n          y = _store$getComponent.y;\n\n      var result = { x: x, y: y };\n\n      switch (intent.direction) {\n        case 'down':\n          result.y += 1;\n          break;\n        case 'up':\n          result.y -= 1;\n          break;\n        case 'left':\n          result.x -= 1;\n          break;\n        case 'right':\n          result.x += 1;\n          break;\n        default:\n          breakLoop('Invalid movement direction', entity);\n          break;\n      }\n\n      store.addComponent(entity, 'moveIntent', result);\n    });\n  };\n};\n\nexports.default = evaluateMovementSystem;\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar collisionSystem = function collisionSystem() {\n  return function (store) {\n    var entities = store.getEntitiesWith(['moveIntent', 'collides']);\n    var collisionMap = store.getCache('collisions');\n\n    entities.forEach(function (entity) {\n      var _store$getComponent = store.getComponent(entity, 'moveIntent'),\n          x = _store$getComponent.x,\n          y = _store$getComponent.y;\n\n      if (collisionMap[x + ',' + y]) {\n        store.removeComponent(entity, 'moveIntent');\n      }\n    });\n  };\n};\n\nexports.default = collisionSystem;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar cacheCollisions = function cacheCollisions() {\n  return function (store) {\n    var entities = store.getEntitiesWith(['collides', 'position']);\n\n    var collisionMap = entities.reduce(function (map, entity) {\n      var _store$getComponent = store.getComponent(entity, 'position'),\n          x = _store$getComponent.x,\n          y = _store$getComponent.y;\n\n      return _extends({}, map, _defineProperty({}, x + ',' + y, true));\n    }, {});\n\n    store.setCache('collisions', collisionMap);\n  };\n};\n\nexports.default = cacheCollisions;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar runLoop = function runLoop(store, systems) {\n  var loop = true;\n  var iteration = 0;\n  var breakLoop = function breakLoop(message) {\n    console.warn(message);\n    loop = false;\n  };\n\n  while (loop) {\n    iteration += 1;\n\n    if (iteration > 10) {\n      breakLoop('Iteration limit reached');\n    }\n\n    systems.forEach(function (system) {\n      return system(store, breakLoop);\n    });\n  }\n};\n\nexports.default = runLoop;\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar EVENT = 'keydown';\n\nvar createInputHandler = function createInputHandler(callback) {\n  var handler = function handler(event) {\n    if (event && !event.repeat) {\n      switch (event.code) {\n        case 'KeyW':\n        case 'ArrowUp':\n          callback('up');\n          break;\n        case 'KeyS':\n        case 'ArrowDown':\n          callback('down');\n          break;\n        case 'KeyA':\n        case 'ArrowLeft':\n          callback('left');\n          break;\n        case 'KeyD':\n        case 'ArrowRight':\n          callback('right');\n          break;\n        default:\n          break;\n      }\n    }\n  };\n\n  window.addEventListener(EVENT, handler);\n\n  return function () {\n    return window.removeEventListener(EVENT, handler);\n  };\n};\n\nexports.default = createInputHandler;\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _ = __webpack_require__(18);\n\nvar MAP = ['          ', ' ######## ', '##......# ', '#...@...# ', '#.......# ', '##......##', ' #.......#', ' #########'];\n\nvar buildMap = function buildMap(store) {\n  return MAP.forEach(function (row, y) {\n    row.split('').forEach(function (cell, x) {\n      switch (cell) {\n        case '@':\n          (0, _.createPlayer)(store, { x: x, y: y });\n          (0, _.createFloor)(store, { x: x, y: y });\n          break;\n        case '#':\n          (0, _.createWall)(store, { x: x, y: y });\n          break;\n        case '.':\n          (0, _.createFloor)(store, { x: x, y: y });\n          break;\n        default:\n          break;\n      }\n    });\n  });\n};\n\nexports.default = buildMap;\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar createPlayer = function createPlayer(store, position) {\n  var entity = store.createEntity();\n\n  store.addComponent(entity, 'position', position);\n  store.addComponent(entity, 'tile', { character: '@', layer: 1 });\n  store.addComponent(entity, 'playerControlled');\n  store.addComponent(entity, 'collides');\n\n  return entity;\n};\n\nvar createWall = function createWall(store, position) {\n  var entity = store.createEntity();\n\n  store.addComponent(entity, 'position', position);\n  store.addComponent(entity, 'tile', { character: '#' });\n  store.addComponent(entity, 'collides');\n\n  return entity;\n};\n\nvar createFloor = function createFloor(store, position) {\n  var entity = store.createEntity();\n\n  store.addComponent(entity, 'position', position);\n  store.addComponent(entity, 'tile', { character: '.' });\n\n  return entity;\n};\n\nexports.createPlayer = createPlayer;\nexports.createWall = createWall;\nexports.createFloor = createFloor;\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar KEYS = {\n  up: 'ArrowUp',\n  down: 'ArrowDown',\n  left: 'ArrowLeft',\n  right: 'ArrowRight'\n};\n\nvar dispatchKey = function dispatchKey(key) {\n  return function () {\n    var e = new Event('keydown');\n    e.code = key;\n    window.dispatchEvent(e);\n  };\n};\n\nvar buildControls = function buildControls() {\n  Object.keys(KEYS).forEach(function (key) {\n    var button = document.getElementById(key + '-button');\n\n    button.addEventListener('click', dispatchKey(KEYS[key]));\n  });\n};\n\nexports.default = buildControls;\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// main.40dd06ce.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 40dd06ce7d7a9b6551c6","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\nvar rng;\n\nvar crypto = global.crypto || global.msCrypto; // for IE 11\nif (crypto && crypto.getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n  rng = function whatwgRNG() {\n    crypto.getRandomValues(rnds8);\n    return rnds8;\n  };\n}\n\nif (!rng) {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n  rng = function() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n\nmodule.exports = rng;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/uuid/lib/rng-browser.js\n// module id = 0\n// module chunks = 0","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  return bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]];\n}\n\nmodule.exports = bytesToUuid;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/uuid/lib/bytesToUuid.js\n// module id = 1\n// module chunks = 0","import Store from './utils/store'\nimport systems from './systems'\nimport runLoop from './utils/loop'\nimport createInputHandler from './utils/inputHandler'\nimport buildMap from './assemblages/map'\nimport buildOnScreenControls from './utils/onScreenControls'\n\nimport './index.css'\n\nconst store = new Store()\n\ncreateInputHandler((direction) => {\n  store.setCache('playerIntent', { type: 'move', direction })\n  runLoop(store, systems)\n})\n\nbuildMap(store)\nrunLoop(store, systems)\n\nbuildOnScreenControls()\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import { v4 as uuid } from 'uuid'\n\nclass Store {\n  constructor() {\n    this.entities = {}\n    this.components = {}\n    this.caches = {}\n  }\n\n  createEntity() {\n    const id = uuid()\n    this.entities[id] = true\n\n    return id\n  }\n\n  setCache(key, cache) {\n    this.caches[key] = cache\n  }\n\n  getCache(key) {\n    return this.caches[key]\n  }\n\n  addComponent(entity, component, state = true) {\n    if (!this.components[component]) {\n      this.components[component] = {}\n    }\n\n    this.components[component][entity] = state\n  }\n\n  removeComponent(entity, component) {\n    if (!this.components[component]) {\n      this.components[component] = {}\n    }\n\n    this.components[component][entity] = null\n  }\n\n  getEntitiesWith(components) {\n    const allEntities = Object.keys(this.entities)\n\n    return allEntities.filter(entity => (\n      components.every(component => this.getComponent(entity, component))\n    ))\n  }\n\n  getComponent(entity, component) {\n    return this.components[component] && this.components[component][entity]\n  }\n\n  debugComponents() {\n    console.log(this.components)\n  }\n}\n\nexport default Store\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/store.js","var v1 = require('./v1');\nvar v4 = require('./v4');\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/uuid/index.js\n// module id = 4\n// module chunks = 0","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\n// random #'s we need to init node and clockseq\nvar _seedBytes = rng();\n\n// Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\nvar _nodeId = [\n  _seedBytes[0] | 0x01,\n  _seedBytes[1], _seedBytes[2], _seedBytes[3], _seedBytes[4], _seedBytes[5]\n];\n\n// Per 4.2.2, randomize (14 bit) clockseq\nvar _clockseq = (_seedBytes[6] << 8 | _seedBytes[7]) & 0x3fff;\n\n// Previous uuid creation time\nvar _lastMSecs = 0, _lastNSecs = 0;\n\n// See https://github.com/broofa/node-uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  var node = options.node || _nodeId;\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/uuid/v1.js\n// module id = 5\n// module chunks = 0","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\n} catch(e) {\n\t// This works if the window reference is available\n\tif(typeof window === \"object\")\n\t\tg = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 6\n// module chunks = 0","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options == 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/uuid/v4.js\n// module id = 7\n// module chunks = 0","import renderSystem from './render'\nimport playerControlSystem from './playerControl'\nimport applyMovementSystem from './applyMovement'\nimport evaluateMovementSystem from './evaluateMovement'\nimport collisionSystem from './collision'\nimport cacheCollisionsSystem from './cacheCollisions'\n\nexport default [\n  cacheCollisionsSystem(),\n  playerControlSystem(),\n  evaluateMovementSystem(),\n  collisionSystem(),\n  applyMovementSystem(),\n  renderSystem(),\n]\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/index.js","const TILE_SIZE = 20\n\nconst renderSystem = () => {\n  const canvas = document.getElementById('canvas')\n  const context = canvas.getContext('2d')\n  const layers = []\n\n  canvas.width = 10 * TILE_SIZE\n  canvas.height = 10 * TILE_SIZE\n\n  return (store) => {\n    const entities = store.getEntitiesWith(['tile', 'position'])\n    context.clearRect(0, 0, canvas.width, canvas.height)\n    layers.forEach((layer) => {\n      layer.getContext('2d').clearRect(0, 0, canvas.width, canvas.height)\n    })\n\n    entities.forEach((entity) => {\n      const tile = store.getComponent(entity, 'tile')\n      const position = store.getComponent(entity, 'position')\n      const x = position.x * TILE_SIZE\n      const y = position.y * TILE_SIZE\n      const { layer = 0 } = tile\n\n      if (!layers[layer]) {\n        layers[layer] = canvas.cloneNode()\n      }\n\n      const ctx = layers[layer].getContext('2d')\n\n      ctx.fillStyle = 'black'\n      ctx.fillRect(x, y, TILE_SIZE, TILE_SIZE)\n\n      ctx.font = '20px monospace'\n      ctx.fillStyle = 'white'\n      ctx.fillText(tile.character, x, y + TILE_SIZE)\n\n      ctx.restore()\n    })\n\n    layers.forEach((layer) => {\n      context.drawImage(layer, 0, 0)\n    })\n  }\n}\n\nexport default renderSystem\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/render.js","const playerControlSystem = () => (store, breakLoop) => {\n  const intent = store.getCache('playerIntent')\n\n  if (intent && intent.type) {\n    const entities = store.getEntitiesWith(['playerControlled'])\n\n    entities.forEach((entity) => {\n      switch (intent.type) {\n        case 'move':\n          store.addComponent(entity, 'moveIntent', intent)\n          break\n        default:\n          breakLoop('Invalid intent from ', entity)\n          break\n      }\n    })\n  } else {\n    breakLoop('No intent found')\n  }\n\n  store.setCache('playerIntent', null)\n}\n\nexport default playerControlSystem\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/playerControl.js","const applyMovementSystem = () => (store) => {\n  const entities = store.getEntitiesWith(['moveIntent', 'position'])\n\n  entities.forEach((entity) => {\n    const intent = store.getComponent(entity, 'moveIntent')\n\n    store.addComponent(entity, 'position', intent)\n    store.removeComponent(entity, 'moveIntent')\n  })\n}\n\nexport default applyMovementSystem\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/applyMovement.js","const evaluateMovementSystem = () => (store, breakLoop) => {\n  const entities = store.getEntitiesWith(['moveIntent', 'position'])\n\n  entities.forEach((entity) => {\n    const intent = store.getComponent(entity, 'moveIntent')\n    const { x, y } = store.getComponent(entity, 'position')\n    const result = { x, y }\n\n    switch (intent.direction) {\n      case 'down':\n        result.y += 1\n        break\n      case 'up':\n        result.y -= 1\n        break\n      case 'left':\n        result.x -= 1\n        break\n      case 'right':\n        result.x += 1\n        break\n      default:\n        breakLoop('Invalid movement direction', entity)\n        break\n    }\n\n    store.addComponent(entity, 'moveIntent', result)\n  })\n}\n\nexport default evaluateMovementSystem\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/evaluateMovement.js","const collisionSystem = () => (store) => {\n  const entities = store.getEntitiesWith(['moveIntent', 'collides'])\n  const collisionMap = store.getCache('collisions')\n\n  entities.forEach((entity) => {\n    const { x, y } = store.getComponent(entity, 'moveIntent')\n\n    if (collisionMap[`${x},${y}`]) {\n      store.removeComponent(entity, 'moveIntent')\n    }\n  })\n}\n\nexport default collisionSystem\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/collision.js","const cacheCollisions = () => (store) => {\n  const entities = store.getEntitiesWith(['collides', 'position'])\n\n  const collisionMap = entities.reduce((map, entity) => {\n    const { x, y } = store.getComponent(entity, 'position')\n\n    return {\n      ...map,\n      [`${x},${y}`]: true,\n    }\n  }, {})\n\n  store.setCache('collisions', collisionMap)\n}\n\nexport default cacheCollisions\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/cacheCollisions.js","const runLoop = (store, systems) => {\n  let loop = true\n  let iteration = 0\n  const breakLoop = (message) => {\n    console.warn(message)\n    loop = false\n  }\n\n  while (loop) {\n    iteration += 1\n\n    if (iteration > 10) {\n      breakLoop('Iteration limit reached')\n    }\n\n    systems.forEach(system => system(store, breakLoop))\n  }\n}\n\nexport default runLoop\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/loop.js","const EVENT = 'keydown'\n\nconst createInputHandler = (callback) => {\n  const handler = (event) => {\n    if (event && !event.repeat) {\n      switch (event.code) {\n        case 'KeyW':\n        case 'ArrowUp':\n          callback('up')\n          break\n        case 'KeyS':\n        case 'ArrowDown':\n          callback('down')\n          break\n        case 'KeyA':\n        case 'ArrowLeft':\n          callback('left')\n          break\n        case 'KeyD':\n        case 'ArrowRight':\n          callback('right')\n          break\n        default:\n          break\n      }\n    }\n  }\n\n  window.addEventListener(EVENT, handler)\n\n  return () => window.removeEventListener(EVENT, handler)\n}\n\nexport default createInputHandler\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/inputHandler.js","import { createPlayer, createWall, createFloor } from './'\n\nconst MAP = [\n  '          ',\n  ' ######## ',\n  '##......# ',\n  '#...@...# ',\n  '#.......# ',\n  '##......##',\n  ' #.......#',\n  ' #########',\n]\n\nconst buildMap = store => MAP.forEach((row, y) => {\n  row.split('').forEach((cell, x) => {\n    switch (cell) {\n      case '@':\n        createPlayer(store, { x, y })\n        createFloor(store, { x, y })\n        break\n      case '#':\n        createWall(store, { x, y })\n        break\n      case '.':\n        createFloor(store, { x, y })\n        break\n      default:\n        break\n    }\n  })\n})\n\nexport default buildMap\n\n\n\n// WEBPACK FOOTER //\n// ./src/assemblages/map.js","const createPlayer = (store, position) => {\n  const entity = store.createEntity()\n\n  store.addComponent(entity, 'position', position)\n  store.addComponent(entity, 'tile', { character: '@', layer: 1 })\n  store.addComponent(entity, 'playerControlled')\n  store.addComponent(entity, 'collides')\n\n  return entity\n}\n\nconst createWall = (store, position) => {\n  const entity = store.createEntity()\n\n  store.addComponent(entity, 'position', position)\n  store.addComponent(entity, 'tile', { character: '#' })\n  store.addComponent(entity, 'collides')\n\n  return entity\n}\n\nconst createFloor = (store, position) => {\n  const entity = store.createEntity()\n\n  store.addComponent(entity, 'position', position)\n  store.addComponent(entity, 'tile', { character: '.' })\n\n  return entity\n}\n\nexport {\n  createPlayer,\n  createWall,\n  createFloor,\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/assemblages/index.js","const KEYS = {\n  up: 'ArrowUp',\n  down: 'ArrowDown',\n  left: 'ArrowLeft',\n  right: 'ArrowRight',\n}\n\nconst dispatchKey = key => () => {\n  const e = new Event('keydown')\n  e.code = key\n  window.dispatchEvent(e)\n}\n\nconst buildControls = () => {\n  Object.keys(KEYS).forEach((key) => {\n    const button = document.getElementById(`${key}-button`)\n\n    button.addEventListener('click', dispatchKey(KEYS[key]))\n  })\n}\n\nexport default buildControls\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/onScreenControls.js"],"sourceRoot":""}