{"version":3,"sources":["webpack:///main.d15a88ea.js","webpack:///webpack/bootstrap d15a88eab687b84e4404","webpack:///./node_modules/uuid/lib/rng-browser.js","webpack:///./node_modules/uuid/lib/bytesToUuid.js","webpack:///./src/assemblages/index.js","webpack:///./src/index.js","webpack:///./src/utils/store.js","webpack:///./node_modules/uuid/index.js","webpack:///./node_modules/uuid/v1.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/uuid/v4.js","webpack:///./src/systems/index.js","webpack:///./src/systems/render.js","webpack:///./src/systems/playerControl.js","webpack:///./src/systems/applyMovement.js","webpack:///./src/systems/evaluateMovement.js","webpack:///./src/systems/collision.js","webpack:///./src/systems/cacheCollisions.js","webpack:///./src/systems/bumpAttack.js","webpack:///./src/systems/attack.js","webpack:///./src/systems/damage.js","webpack:///./src/systems/death.js","webpack:///./src/utils/loop.js","webpack:///./src/utils/inputHandler.js","webpack:///./src/assemblages/map.js","webpack:///./src/utils/onScreenControls.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","default","object","property","prototype","hasOwnProperty","p","s","global","rng","crypto","msCrypto","getRandomValues","rnds8","Uint8Array","rnds","Array","r","Math","random","bytesToUuid","buf","offset","bth","byteToHex","toString","substr","value","createPlayer","store","position","entity","createEntity","addComponent","character","layer","createEnemy","createWall","createFloor","createGravestone","_interopRequireDefault","obj","_store","_store2","_systems","_systems2","_loop","_loop2","_inputHandler","_inputHandler2","_map","_map2","_onScreenControls","_onScreenControls2","direction","setCache","type","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","length","descriptor","writable","key","protoProps","staticProps","_uuid","Store","this","entities","components","caches","id","v4","_this","keys","forEach","component","removeComponent","cache","state","arguments","_this2","filter","every","getComponent","console","log","v1","uuid","options","b","clockseq","_clockseq","msecs","Date","getTime","nsecs","_lastNSecs","dt","_lastMSecs","Error","tl","tmh","node","_nodeId","_seedBytes","g","Function","eval","e","window","ii","_render","_render2","_playerControl","_playerControl2","_applyMovement","_applyMovement2","_evaluateMovement","_evaluateMovement2","_collision","_collision2","_cacheCollisions","_cacheCollisions2","_bumpAttack","_bumpAttack2","_attack","_attack2","_damage","_damage2","_death","_death2","render","canvas","document","getElementById","context","getContext","layers","width","height","getEntitiesWith","clearRect","tile","x","y","_tile$layer","cloneNode","ctx","fillStyle","fillRect","font","fillText","restore","drawImage","playerControl","breakLoop","intent","getCache","applyMovement","evaluateMovement","_store$getComponent","result","collision","collisionMap","_defineProperty","_extends","assign","source","cacheCollisions","reduce","map","bumpAttack","collidingEntity","attack","receiveDamage","damage","_assemblages","death","health","removeEntity","runLoop","systems","debug","loop","iteration","message","warn","system","createInputHandler","callback","handler","event","repeat","code","addEventListener","removeEventListener","_","MAP","buildMap","row","split","cell","KEYS","up","down","left","right","dispatchKey","Event","dispatchEvent","buildControls"],"mappings":"CAAS,SAAUA,GCInB,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAE,OAGA,IAAAC,GAAAF,EAAAD,IACAI,EAAAJ,EACAK,KACAH,WAUA,OANAJ,GAAAE,GAAAM,KAAAH,EAAAD,QAAAC,IAAAD,QAAAH,GAGAI,EAAAE,KAGAF,EAAAD,QAvBA,GAAAD,KA4BAF,GAAAQ,EAAAT,EAGAC,EAAAS,EAAAP,EAGAF,EAAAU,EAAA,SAAAP,EAAAQ,EAAAC,GACAZ,EAAAa,EAAAV,EAAAQ,IACAG,OAAAC,eAAAZ,EAAAQ,GACAK,gBACAC,cACAC,IAAAN,KAMAZ,EAAAmB,EAAA,SAAAf,GACA,GAAAQ,GAAAR,KAAAgB,WACA,WAA2B,MAAAhB,GAAAiB,SAC3B,WAAiC,MAAAjB,GAEjC,OADAJ,GAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAS,EAAAC,GAAsD,MAAAT,QAAAU,UAAAC,eAAAlB,KAAAe,EAAAC,IAGtDvB,EAAA0B,EAAA,GAGA1B,IAAA2B,EAAA,KDMM,SAAUvB,EAAQD,EAASH,aEnEjC4B,GAIA,GAAAC,GAEAC,EAAAF,EAAAE,QAAAF,EAAAG,QACA,IAAAD,KAAAE,gBAAA,CAEA,GAAAC,GAAA,GAAAC,YAAA,GACAL,GAAA,WAEA,MADAC,GAAAE,gBAAAC,GACAA,GAIA,IAAAJ,EAAA,CAKA,GAAAM,GAAA,GAAAC,OAAA,GACAP,GAAA,WACA,OAAAQ,GAAAhC,EAAA,EAAsBA,EAAA,GAAQA,IAC9B,MAAAA,KAAAgC,EAAA,WAAAC,KAAAC,UACAJ,EAAA9B,GAAAgC,MAAA,EAAAhC,IAAA,MAGA,OAAA8B,IAIA/B,EAAAD,QAAA0B,IFuE6BtB,KAAKJ,EAASH,EAAoB,KAIzD,SAAUI,EAAQD,GGlGxB,QAAAqC,GAAAC,EAAAC,GACA,GAAArC,GAAAqC,GAAA,EACAC,EAAAC,CACA,OAAAD,GAAAF,EAAApC,MAAAsC,EAAAF,EAAApC,MACAsC,EAAAF,EAAApC,MAAAsC,EAAAF,EAAApC,MAAA,IACAsC,EAAAF,EAAApC,MAAAsC,EAAAF,EAAApC,MAAA,IACAsC,EAAAF,EAAApC,MAAAsC,EAAAF,EAAApC,MAAA,IACAsC,EAAAF,EAAApC,MAAAsC,EAAAF,EAAApC,MAAA,IACAsC,EAAAF,EAAApC,MAAAsC,EAAAF,EAAApC,MACAsC,EAAAF,EAAApC,MAAAsC,EAAAF,EAAApC,MACAsC,EAAAF,EAAApC,MAAAsC,EAAAF,EAAApC,MAdA,OADAuC,MACAvC,EAAA,EAAeA,EAAA,MAASA,EACxBuC,EAAAvC,MAAA,KAAAwC,SAAA,IAAAC,OAAA,EAgBA1C,GAAAD,QAAAqC,GHkHM,SAAUpC,EAAQD,EAASH,GAEjC,YAGAc,QAAOC,eAAeZ,EAAS,cAC7B4C,UI9IF,IAAMC,GAAe,SAACC,EAAOC,GAC3B,GAAMC,GAASF,EAAMG,cAQrB,OANAH,GAAMI,aAAaF,EAAQ,WAAYD,GACvCD,EAAMI,aAAaF,EAAQ,QAAUG,UAAW,IAAKC,MAAO,IAC5DN,EAAMI,aAAaF,EAAQ,oBAC3BF,EAAMI,aAAaF,EAAQ,YAC3BF,EAAMI,aAAaF,EAAQ,aAEpBA,GAGHK,EAAc,SAACP,EAAOC,GAC1B,GAAMC,GAASF,EAAMG,cAOrB,OALAH,GAAMI,aAAaF,EAAQ,WAAYD,GACvCD,EAAMI,aAAaF,EAAQ,QAAUG,UAAW,IAAKC,MAAO,IAC5DN,EAAMI,aAAaF,EAAQ,YAC3BF,EAAMI,aAAaF,EAAQ,UAAYJ,MAAO,IAEvCI,GAGHM,EAAa,SAACR,EAAOC,GACzB,GAAMC,GAASF,EAAMG,cAMrB,OAJAH,GAAMI,aAAaF,EAAQ,WAAYD,GACvCD,EAAMI,aAAaF,EAAQ,QAAUG,UAAW,MAChDL,EAAMI,aAAaF,EAAQ,YAEpBA,GAGHO,EAAc,SAACT,EAAOC,GAC1B,GAAMC,GAASF,EAAMG,cAKrB,OAHAH,GAAMI,aAAaF,EAAQ,WAAYD,GACvCD,EAAMI,aAAaF,EAAQ,QAAUG,UAAW,MAEzCH,GAGHQ,EAAmB,SAACV,EAAOC,GAC/B,GAAMC,GAASF,EAAMG,cAKrB,OAHAH,GAAMI,aAAaF,EAAQ,WAAYD,GACvCD,EAAMI,aAAaF,EAAQ,QAAUG,UAAW,IAAKC,MAAO,IAErDJ,EJmJThD,GI/IE6C,eJgJF7C,EI/IEqD,cJgJFrD,EI/IEsD,aJgJFtD,EI/IEuD,cJgJFvD,EI/IEwD,oBJmJI,SAAUvD,EAAQD,EAASH,GAEjC,YA6BA,SAAS4D,GAAuBC,GAAO,MAAOA,IAAOA,EAAIzC,WAAayC,GAAQxC,QAASwC,GK1OvF,GAAAC,GAAA9D,EAAA,GLkNI+D,EAAUH,EAAuBE,GKjNrCE,EAAAhE,EAAA,GLqNIiE,EAAYL,EAAuBI,GKpNvCE,EAAAlE,EAAA,ILwNImE,EAASP,EAAuBM,GKvNpCE,EAAApE,EAAA,IL2NIqE,EAAiBT,EAAuBQ,GK1N5CE,EAAAtE,EAAA,IL8NIuE,EAAQX,EAAuBU,GK7NnCE,EAAAxE,EAAA,ILiOIyE,EAAqBb,EAAuBY,EK/NhDxE,GAAA,GAEA,IAAMiD,GAAQ,GAAAc,GAAA1C,WAEdgD,EAAAhD,SAAmB,SAACqD,GAClBzB,EAAM0B,SAAS,gBAAkBC,KAAM,OAAQF,iBAC/CP,EAAA9C,SAAQ4B,EAARgB,EAAA5C,cAGFkD,EAAAlD,SAAS4B,MACTkB,EAAA9C,SAAQ4B,EAARgB,EAAA5C,YAEAoD,EAAApD,YLuOM,SAAUjB,EAAQD,EAASH,GAEjC,YAWA,SAAS6E,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCARhHlE,OAAOC,eAAeZ,EAAS,cAC7B4C,UAGF,IAAIkC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAI/E,GAAI,EAAGA,EAAI+E,EAAMC,OAAQhF,IAAK,CAAE,GAAIiF,GAAaF,EAAM/E,EAAIiF,GAAWrE,WAAaqE,EAAWrE,eAAqBqE,EAAWtE,gBAAyB,SAAWsE,KAAYA,EAAWC,aAAiBzE,OAAOC,eAAeoE,EAAQG,EAAWE,IAAKF,IAAiB,MAAO,UAAUP,EAAaU,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiBH,EAAYvD,UAAWiE,GAAiBC,GAAaR,EAAiBH,EAAaW,GAAqBX,MMnQhiBY,EAAA3F,EAAA,GAEM4F,ENuQM,WMtQV,QAAAA,KAAcf,EAAAgB,KAAAD,GACZC,KAAKC,YACLD,KAAKE,cACLF,KAAKG,UNuVP,MA3EAf,GAAaW,IACXJ,IAAK,eACLzC,MAAO,WM1QP,GAAMkD,MAAKN,EAAAO,KAGX,OAFAL,MAAKC,SAASG,MAEPA,KN8QPT,IAAK,eACLzC,MAAO,SM5QII,GAAQ,GAAAgD,GAAAN,IACnBA,MAAKC,SAAS3C,GAAU,KAExBrC,OAAOsF,KAAKP,KAAKE,YAAYM,QAAQ,SAAAC,GAAA,MAAaH,GAAKI,gBAAgBpD,EAAQmD,QNmR/Ed,IAAK,WACLzC,MAAO,SMjRAyC,EAAKgB,GACZX,KAAKG,OAAOR,GAAOgB,KNoRnBhB,IAAK,WACLzC,MAAO,SMlRAyC,GACP,MAAOK,MAAKG,OAAOR,MNqRnBA,IAAK,eACLzC,MAAO,SMnRII,EAAQmD,GAAyB,GAAdG,KAAcC,UAAArB,OAAA,YAAAqB,UAAA,KAAAA,UAAA,EACvCb,MAAKE,WAAWO,KACnBT,KAAKE,WAAWO,OAGlBT,KAAKE,WAAWO,GAAWnD,GAAUsD,KNwRrCjB,IAAK,kBACLzC,MAAO,SMtROI,EAAQmD,GACjBT,KAAKE,WAAWO,KACnBT,KAAKE,WAAWO,OAGlBT,KAAKE,WAAWO,GAAWnD,GAAU,QNyRrCqC,IAAK,kBACLzC,MAAO,SMvROgD,GAAY,GAAAY,GAAAd,IAG1B,OAFoB/E,QAAOsF,KAAKP,KAAKC,UAElBc,OAAO,SAAAzD,GAAA,MACxB4C,GAAWc,MAAM,SAAAP,GAAA,MAAaK,GAAKG,aAAa3D,EAAQmD,UN+R1Dd,IAAK,eACLzC,MAAO,SM5RII,EAAQmD,GACnB,MAAOT,MAAKE,WAAWO,IAAcT,KAAKE,WAAWO,GAAWnD,MN+RhEqC,IAAK,kBACLzC,MAAO,WM3RPgE,QAAQC,IAAInB,KAAKE,gBNiSZH,IAGTzF,GAAQkB,QMhSOuE,GNoST,SAAUxF,EAAQD,EAASH,GOpWjC,GAAAiH,GAAAjH,EAAA,GACAkG,EAAAlG,EAAA,GAEAkH,EAAAhB,CACAgB,GAAAD,KACAC,EAAAhB,KAEA9F,EAAAD,QAAA+G,GP2WM,SAAU9G,EAAQD,EAASH,GQ1VjC,QAAAiH,GAAAE,EAAA1E,EAAAC,GACA,GAAArC,GAAAoC,GAAAC,GAAA,EACA0E,EAAA3E,KAEA0E,QAEA,IAAAE,YAAAF,EAAAE,SAAAF,EAAAE,SAAAC,EAMAC,WAAAJ,EAAAI,MAAAJ,EAAAI,UAAAC,OAAAC,UAIAC,WAAAP,EAAAO,MAAAP,EAAAO,MAAAC,EAAA,EAGAC,EAAAL,EAAAM,GAAAH,EAAAC,GAAA,GAcA,IAXAC,EAAA,YAAAT,EAAAE,WACAA,IAAA,UAKAO,EAAA,GAAAL,EAAAM,aAAAV,EAAAO,QACAA,EAAA,GAIAA,GAAA,IACA,SAAAI,OAAA,kDAGAD,GAAAN,EACAI,EAAAD,EACAJ,EAAAD,EAGAE,GAAA,WAGA,IAAAQ,IAAA,eAAAR,GAAAG,GAAA,UACAN,GAAA/G,KAAA0H,IAAA,OACAX,EAAA/G,KAAA0H,IAAA,OACAX,EAAA/G,KAAA0H,IAAA,MACAX,EAAA/G,KAAA,IAAA0H,CAGA,IAAAC,GAAAT,EAAA,wBACAH,GAAA/G,KAAA2H,IAAA,MACAZ,EAAA/G,KAAA,IAAA2H,EAGAZ,EAAA/G,KAAA2H,IAAA,SACAZ,EAAA/G,KAAA2H,IAAA,OAGAZ,EAAA/G,KAAAgH,IAAA,MAGAD,EAAA/G,KAAA,IAAAgH,CAIA,QADAY,GAAAd,EAAAc,MAAAC,EACA/G,EAAA,EAAiBA,EAAA,IAAOA,EACxBiG,EAAA/G,EAAAc,GAAA8G,EAAA9G,EAGA,OAAAsB,IAAAD,EAAA4E,GAhGA,GAAAvF,GAAA7B,EAAA,GACAwC,EAAAxC,EAAA,GAQAmI,EAAAtG,IAGAqG,GACA,EAAAC,EAAA,GACAA,EAAA,GAAAA,EAAA,GAAAA,EAAA,GAAAA,EAAA,GAAAA,EAAA,IAIAb,EAAA,OAAAa,EAAA,MAAAA,EAAA,IAGAN,EAAA,EAAAF,EAAA,CA8EAvH,GAAAD,QAAA8G,GRyXM,SAAU7G,EAAQD,GS5dxB,GAAAiI,EAGAA,GAAA,WACA,MAAAvC,QAGA,KAEAuC,KAAAC,SAAA,qBAAAC,MAAA,QACC,MAAAC,GAED,gBAAAC,UACAJ,EAAAI,QAOApI,EAAAD,QAAAiI,GTmeM,SAAUhI,EAAQD,EAASH,GUpfjC,QAAAkG,GAAAiB,EAAA1E,EAAAC,GACA,GAAArC,GAAAoC,GAAAC,GAAA,CAEA,iBAAA6F,KACA9F,EAAA,UAAA0E,EAAA,GAAA/E,OAAA,SACA+E,EAAA,MAEAA,OAEA,IAAAhF,GAAAgF,EAAA5E,SAAA4E,EAAAtF,SAOA,IAJAM,EAAA,MAAAA,EAAA,MACAA,EAAA,MAAAA,EAAA,OAGAM,EACA,OAAAgG,GAAA,EAAoBA,EAAA,KAASA,EAC7BhG,EAAApC,EAAAoI,GAAAtG,EAAAsG,EAIA,OAAAhG,IAAAD,EAAAL,GAzBA,GAAAN,GAAA7B,EAAA,GACAwC,EAAAxC,EAAA,EA2BAI,GAAAD,QAAA+F,GV8fM,SAAU9F,EAAQD,EAASH,GAEjC,YA+CA,SAAS4D,GAAuBC,GAAO,MAAOA,IAAOA,EAAIzC,WAAayC,GAAQxC,QAASwC,GA5CvF/C,OAAOC,eAAeZ,EAAS,cAC7B4C,UWhiBF,IAAA2F,GAAA1I,EAAA,IXqiBI2I,EAAW/E,EAAuB8E,GWpiBtCE,EAAA5I,EAAA,IXwiBI6I,EAAkBjF,EAAuBgF,GWviB7CE,EAAA9I,EAAA,IX2iBI+I,EAAkBnF,EAAuBkF,GW1iB7CE,EAAAhJ,EAAA,IX8iBIiJ,EAAqBrF,EAAuBoF,GW7iBhDE,EAAAlJ,EAAA,IXijBImJ,EAAcvF,EAAuBsF,GWhjBzCE,EAAApJ,EAAA,IXojBIqJ,EAAoBzF,EAAuBwF,GWnjB/CE,EAAAtJ,EAAA,IXujBIuJ,EAAe3F,EAAuB0F,GWtjB1CE,EAAAxJ,EAAA,IX0jBIyJ,EAAW7F,EAAuB4F,GWzjBtCE,EAAA1J,EAAA,IX6jBI2J,EAAW/F,EAAuB8F,GW5jBtCE,EAAA5J,EAAA,IXgkBI6J,EAAUjG,EAAuBgG,EAIrCzJ,GAAQkB,YWjkBNgI,EAAAhI,cACAwH,EAAAxH,cACA4H,EAAA5H,cACAkI,EAAAlI,cACA8H,EAAA9H,cACA0H,EAAA1H,cACAoI,EAAApI,cACAsI,EAAAtI,cACAwI,EAAAxI,cACAsH,EAAAtH,aX4jBI,SAAUjB,EAAQD,EAASH,GAEjC,YAGAc,QAAOC,eAAeZ,EAAS,cAC7B4C,UYvlBF,IAEM+G,GAAS,WACb,GAAMC,GAASC,SAASC,eAAe,UACjCC,EAAUH,EAAOI,WAAW,MAC5BC,IAKN,OAHAL,GAAOM,MAAQ,IACfN,EAAOO,OAAS,IAET,SAACrH,GACN,GAAM6C,GAAW7C,EAAMsH,iBAAiB,OAAQ,YAChDL,GAAQM,UAAU,EAAG,EAAGT,EAAOM,MAAON,EAAOO,QAC7CF,EAAO/D,QAAQ,SAAC9C,GACdA,EAAM4G,WAAW,MAAMK,UAAU,EAAG,EAAGT,EAAOM,MAAON,EAAOO,UAG9DxE,EAASO,QAAQ,SAAClD,GAChB,GAAMsH,GAAOxH,EAAM6D,aAAa3D,EAAQ,QAClCD,EAAWD,EAAM6D,aAAa3D,EAAQ,YACtCuH,EApBM,GAoBFxH,EAASwH,EACbC,EArBM,GAqBFzH,EAASyH,EAJQC,EAKLH,EAAdlH,iBALmBqH,EAKX,EALWA,CAOtBR,GAAO7G,KACV6G,EAAO7G,GAASwG,EAAOc,YAGzB,IAAMC,GAAMV,EAAO7G,GAAO4G,WAAW,KAErCW,GAAIC,UAAY,QAChBD,EAAIE,SAASN,EAAGC,EA/BJ,OAiCZG,EAAIG,KAAO,iBACXH,EAAIC,UAAY,QAChBD,EAAII,SAAST,EAAKnH,UAAWoH,EAAGC,EAnCpB,IAqCZG,EAAIK,YAGNf,EAAO/D,QAAQ,SAAC9C,GACd2G,EAAQkB,UAAU7H,EAAO,EAAG,MZgmBlCpD,GAAQkB,QY3lBOyI,GZ+lBT,SAAU1J,EAAQD,EAASH,GAEjC,YAGAc,QAAOC,eAAeZ,EAAS,cAC7B4C,UanpBF,IAAMsI,GAAgB,iBAAM,UAACpI,EAAOqI,GAClC,GAAMC,GAAStI,EAAMuI,SAAS,eAE1BD,IAAUA,EAAO3G,KACF3B,EAAMsH,iBAAiB,qBAE/BlE,QAAQ,SAAClD,GAChB,OAAQoI,EAAO3G,MACb,IAAK,OACH3B,EAAMI,aAAaF,EAAQ,aAAcoI,EACzC,MACF,SACED,EAAU,uBAAwBnI,MAKxCmI,EAAU,mBAGZrI,EAAM0B,SAAS,eAAgB,Ob0pBjCxE,GAAQkB,QavpBOgK,Gb2pBT,SAAUjL,EAAQD,EAASH,GAEjC,YAGAc,QAAOC,eAAeZ,EAAS,cAC7B4C,UcxrBF,IAAM0I,GAAgB,iBAAM,UAACxI,GACVA,EAAMsH,iBAAiB,aAAc,aAE7ClE,QAAQ,SAAClD,GAChB,GAAMoI,GAAStI,EAAM6D,aAAa3D,EAAQ,aAE1CF,GAAMI,aAAaF,EAAQ,WAAYoI,GACvCtI,EAAMsD,gBAAgBpD,EAAQ,iBdgsBlChD,GAAQkB,Qc5rBOoK,GdgsBT,SAAUrL,EAAQD,EAASH,GAEjC,YAGAc,QAAOC,eAAeZ,EAAS,cAC7B4C,UejtBF,IAAM2I,GAAmB,iBAAM,UAACzI,EAAOqI,GACpBrI,EAAMsH,iBAAiB,aAAc,aAE7ClE,QAAQ,SAAClD,GAChB,GAAMoI,GAAStI,EAAM6D,aAAa3D,EAAQ,cADfwI,EAEV1I,EAAM6D,aAAa3D,EAAQ,YAApCuH,EAFmBiB,EAEnBjB,EAAGC,EAFgBgB,EAEhBhB,EACLiB,GAAWlB,IAAGC,IAEpB,QAAQY,EAAO7G,WACb,IAAK,OACHkH,EAAOjB,GAAK,CACZ,MACF,KAAK,KACHiB,EAAOjB,GAAK,CACZ,MACF,KAAK,OACHiB,EAAOlB,GAAK,CACZ,MACF,KAAK,QACHkB,EAAOlB,GAAK,CACZ,MACF,SACEY,EAAU,6BAA8BnI,GAI5CF,EAAMI,aAAaF,EAAQ,aAAcyI,Mf6tB7CzL,GAAQkB,QeztBOqK,Gf6tBT,SAAUtL,EAAQD,EAASH,GAEjC,YAGAc,QAAOC,eAAeZ,EAAS,cAC7B4C,UgBjwBF,IAAM8I,GAAY,iBAAM,UAAC5I,GACvB,GAAM6C,GAAW7C,EAAMsH,iBAAiB,aAAc,aAChDuB,EAAe7I,EAAMuI,SAAS,aAEpC1F,GAASO,QAAQ,SAAClD,GAAW,GAAAwI,GACV1I,EAAM6D,aAAa3D,EAAQ,cAApCuH,EADmBiB,EACnBjB,EAAGC,EADgBgB,EAChBhB,CAEPmB,GAAgBpB,EAAhB,IAAqBC,IACvB1H,EAAMsD,gBAAgBpD,EAAQ,iBhB4wBpChD,GAAQkB,QgBvwBOwK,GhB2wBT,SAAUzL,EAAQD,EAASH,GAEjC,YASA,SAAS+L,GAAgBlI,EAAK2B,EAAKzC,GAAiK,MAApJyC,KAAO3B,GAAO/C,OAAOC,eAAe8C,EAAK2B,GAAOzC,MAAOA,EAAO9B,cAAkBD,gBAAoBuE,cAA4B1B,EAAI2B,GAAOzC,EAAgBc,EAN3M/C,OAAOC,eAAeZ,EAAS,cAC7B4C,UAGF,IAAIiJ,GAAWlL,OAAOmL,QAAU,SAAU9G,GAAU,IAAK,GAAI9E,GAAI,EAAGA,EAAIqG,UAAUrB,OAAQhF,IAAK,CAAE,GAAI6L,GAASxF,UAAUrG,EAAI,KAAK,GAAImF,KAAO0G,GAAcpL,OAAOU,UAAUC,eAAelB,KAAK2L,EAAQ1G,KAAQL,EAAOK,GAAO0G,EAAO1G,IAAY,MAAOL,IiBjyBjPgH,EAAkB,iBAAM,UAAClJ,GAC7B,GAAM6C,GAAW7C,EAAMsH,iBAAiB,WAAY,aAE9CuB,EAAehG,EAASsG,OAAO,SAACC,EAAKlJ,GAAW,GAAAwI,GACnC1I,EAAM6D,aAAa3D,EAAQ,YAApCuH,EAD4CiB,EAC5CjB,EAAGC,EADyCgB,EACzChB,CAEX,OAAAqB,MACKK,EADLN,KAEMrB,EAFN,IAEWC,EAAMxH,QAInBF,GAAM0B,SAAS,aAAcmH,IjByyB/B3L,GAAQkB,QiBtyBO8K,GjB0yBT,SAAU/L,EAAQD,EAASH,GAEjC,YAGAc,QAAOC,eAAeZ,EAAS,cAC7B4C,UkB/zBF,IAAMuJ,GAAa,iBAAM,UAACrJ,GACxB,GAAM6C,GAAW7C,EAAMsH,iBAAiB,aAAc,WAAY,cAC5DuB,EAAe7I,EAAMuI,SAAS,aAEpC1F,GAASO,QAAQ,SAAClD,GAAW,GAAAwI,GACV1I,EAAM6D,aAAa3D,EAAQ,cAApCuH,EADmBiB,EACnBjB,EAAGC,EADgBgB,EAChBhB,EACL4B,EAAkBT,EAAgBpB,EAAhB,IAAqBC,EAEzC4B,IAAmBtJ,EAAM6D,aAAayF,EAAiB,YACzDtJ,EAAMsD,gBAAgBpD,EAAQ,cAC9BF,EAAMI,aAAaF,EAAQ,gBAAkBgC,OAAQoH,QlB20B3DpM,GAAQkB,QkBt0BOiL,GlB00BT,SAAUlM,EAAQD,EAASH,GAEjC,YAGAc,QAAOC,eAAeZ,EAAS,cAC7B4C,UmB/1BF,IAAMyJ,GAAS,iBAAM,UAACvJ,GACHA,EAAMsH,iBAAiB,iBAE/BlE,QAAQ,SAAClD,GAAW,GAAAwI,GACR1I,EAAM6D,aAAa3D,EAAQ,gBAAtCgC,EADmBwG,EACnBxG,MAERlC,GAAMI,aAAa8B,EAAQ,gBAAiB,GAC5ClC,EAAMsD,gBAAgBpD,EAAQ,mBnBw2BlChD,GAAQkB,QmBp2BOmL,GnBw2BT,SAAUpM,EAAQD,EAASH,GAEjC,YAGAc,QAAOC,eAAeZ,EAAS,cAC7B4C,UoBz3BF,IAAM0J,GAAgB,iBAAM,UAACxJ,GACVA,EAAMsH,iBAAiB,kBAE/BlE,QAAQ,SAAClD,GAChB,GAAMuJ,GAASzJ,EAAM6D,aAAa3D,EAAQ,iBADfwI,EAET1I,EAAM6D,aAAa3D,EAAQ,UAArCJ,EAFmB4I,EAEnB5I,KAERE,GAAMI,aAAaF,EAAQ,UAAYJ,MAAOA,EAAQ2J,IACtDzJ,EAAMsD,gBAAgBpD,EAAQ,oBpBm4BlChD,GAAQkB,QoB/3BOoL,GpBm4BT,SAAUrM,EAAQD,EAASH,GAEjC,YAGAc,QAAOC,eAAeZ,EAAS,cAC7B4C,UqBr5BF,IAAA4J,GAAA3M,EAAA,GAEM4M,EAAQ,iBAAM,UAAC3J,GACFA,EAAMsH,iBAAiB,WAE/BlE,QAAQ,SAAClD,GAChB,GAAM0J,GAAS5J,EAAM6D,aAAa3D,EAAQ,UACpCD,EAAWD,EAAM6D,aAAa3D,EAAQ,WAExC0J,IAAUA,EAAO9J,MAAQ,IAC3BE,EAAM6J,aAAa3J,GAEfD,MACFyJ,EAAAhJ,kBAAiBV,EAAOC,OrBg6BhC/C,GAAQkB,QqB15BOuL,GrB85BT,SAAUxM,EAAQD,EAASH,GAEjC,YAGAc,QAAOC,eAAeZ,EAAS,cAC7B4C,UsBv7BF,IAAMgK,GAAU,SAAC9J,EAAO+J,GAYtB,IAXA,GAAMC,GAAQhK,EAAMuI,SAAS,SACzB0B,KACAC,EAAY,EACV7B,EAAY,SAAC8B,GACbH,GAEFlG,QAAQsG,KAAKD,GAEfF,MAGKA,GACLC,GAAa,EAETA,EAAY,IACd7B,EAAU,2BAGZ0B,EAAQ3G,QAAQ,SAAAiH,GAAA,MAAUA,GAAOrK,EAAOqI,KtB+7B5CnL,GAAQkB,QsB37BO0L,GtB+7BT,SAAU3M,EAAQD,EAASH,GAEjC,YAGAc,QAAOC,eAAeZ,EAAS,cAC7B4C,UuB59BF,IAEMwK,GAAqB,SAACC,GAC1B,GAAMC,GAAU,SAACC,GACf,GAAIA,IAAUA,EAAMC,OAClB,OAAQD,EAAME,MACZ,IAAK,OACL,IAAK,UACHJ,EAAS,KACT,MACF,KAAK,OACL,IAAK,YACHA,EAAS,OACT,MACF,KAAK,OACL,IAAK,YACHA,EAAS,OACT,MACF,KAAK,OACL,IAAK,aACHA,EAAS,UAUjB,OAFAhF,QAAOqF,iBA5BK,UA4BmBJ,GAExB,iBAAMjF,QAAOsF,oBA9BR,UA8BmCL,IvBm+BjDtN,GAAQkB,QuBh+BOkM,GvBo+BT,SAAUnN,EAAQD,EAASH,GAEjC,YAGAc,QAAOC,eAAeZ,EAAS,cAC7B4C,UwB3gCF,IAAAgL,GAAA/N,EAAA,GAOMgO,GACJ,aACA,aACA,aACA,aACA,aACA,aACA,aACA,cAGIC,EAAW,SAAAhL,GAAA,MAAS+K,GAAI3H,QAAQ,SAAC6H,EAAKvD,GAC1CuD,EAAIC,MAAM,IAAI9H,QAAQ,SAAC+H,EAAM1D,GAC3B,OAAQ0D,GACN,IAAK,OACHL,EAAA/K,cAAaC,GAASyH,IAAGC,SACzBoD,EAAArK,aAAYT,GAASyH,IAAGC,KACxB,MACF,KAAK,OACHoD,EAAAtK,YAAWR,GAASyH,IAAGC,KACvB,MACF,KAAK,OACHoD,EAAArK,aAAYT,GAASyH,IAAGC,KACxB,MACF,KAAK,OACHoD,EAAAvK,aAAYP,GAASyH,IAAGC,SACxBoD,EAAArK,aAAYT,GAASyH,IAAGC,WxB0gChCxK,GAAQkB,QwBlgCO4M,GxBsgCT,SAAU7N,EAAQD,EAASH,GAEjC,YAGAc,QAAOC,eAAeZ,EAAS,cAC7B4C,UyBrjCF,IAAMsL,IACJC,GAAI,UACJC,KAAM,YACNC,KAAM,YACNC,MAAO,cAGHC,EAAc,SAAAlJ,GAAA,MAAO,YACzB,GAAM+C,GAAI,GAAIoG,OAAM,UACpBpG,GAAEqF,KAAOpI,EACTgD,OAAOoG,cAAcrG,KAGjBsG,EAAgB,WACpB/N,OAAOsF,KAAKiI,GAAMhI,QAAQ,SAACb,GACVwE,SAASC,eAAkBzE,EAA3B,WAERqI,iBAAiB,QAASa,EAAYL,EAAK7I,OzB6jCtDrF,GAAQkB,QyBzjCOwN,GzB6jCT,SAAUzO,EAAQD","file":"main.d15a88ea.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 3);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(global) {// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\nvar rng;\n\nvar crypto = global.crypto || global.msCrypto; // for IE 11\nif (crypto && crypto.getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n  rng = function whatwgRNG() {\n    crypto.getRandomValues(rnds8);\n    return rnds8;\n  };\n}\n\nif (!rng) {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n  rng = function() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n\nmodule.exports = rng;\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(7)))\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  return bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]];\n}\n\nmodule.exports = bytesToUuid;\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar createPlayer = function createPlayer(store, position) {\n  var entity = store.createEntity();\n\n  store.addComponent(entity, 'position', position);\n  store.addComponent(entity, 'tile', { character: '@', layer: 2 });\n  store.addComponent(entity, 'playerControlled');\n  store.addComponent(entity, 'collides');\n  store.addComponent(entity, 'canAttack');\n\n  return entity;\n};\n\nvar createEnemy = function createEnemy(store, position) {\n  var entity = store.createEntity();\n\n  store.addComponent(entity, 'position', position);\n  store.addComponent(entity, 'tile', { character: 'K', layer: 2 });\n  store.addComponent(entity, 'collides');\n  store.addComponent(entity, 'health', { value: 3 });\n\n  return entity;\n};\n\nvar createWall = function createWall(store, position) {\n  var entity = store.createEntity();\n\n  store.addComponent(entity, 'position', position);\n  store.addComponent(entity, 'tile', { character: '#' });\n  store.addComponent(entity, 'collides');\n\n  return entity;\n};\n\nvar createFloor = function createFloor(store, position) {\n  var entity = store.createEntity();\n\n  store.addComponent(entity, 'position', position);\n  store.addComponent(entity, 'tile', { character: '.' });\n\n  return entity;\n};\n\nvar createGravestone = function createGravestone(store, position) {\n  var entity = store.createEntity();\n\n  store.addComponent(entity, 'position', position);\n  store.addComponent(entity, 'tile', { character: '✝', layer: 1 });\n\n  return entity;\n};\n\nexports.createPlayer = createPlayer;\nexports.createEnemy = createEnemy;\nexports.createWall = createWall;\nexports.createFloor = createFloor;\nexports.createGravestone = createGravestone;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _store = __webpack_require__(4);\n\nvar _store2 = _interopRequireDefault(_store);\n\nvar _systems = __webpack_require__(9);\n\nvar _systems2 = _interopRequireDefault(_systems);\n\nvar _loop = __webpack_require__(20);\n\nvar _loop2 = _interopRequireDefault(_loop);\n\nvar _inputHandler = __webpack_require__(21);\n\nvar _inputHandler2 = _interopRequireDefault(_inputHandler);\n\nvar _map = __webpack_require__(22);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _onScreenControls = __webpack_require__(23);\n\nvar _onScreenControls2 = _interopRequireDefault(_onScreenControls);\n\n__webpack_require__(24);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar store = new _store2.default();\n\n(0, _inputHandler2.default)(function (direction) {\n  store.setCache('playerIntent', { type: 'move', direction: direction });\n  (0, _loop2.default)(store, _systems2.default);\n});\n\n(0, _map2.default)(store);\n(0, _loop2.default)(store, _systems2.default);\n\n(0, _onScreenControls2.default)();\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _uuid = __webpack_require__(5);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Store = function () {\n  function Store() {\n    _classCallCheck(this, Store);\n\n    this.entities = {};\n    this.components = {};\n    this.caches = {};\n  }\n\n  _createClass(Store, [{\n    key: 'createEntity',\n    value: function createEntity() {\n      var id = (0, _uuid.v4)();\n      this.entities[id] = true;\n\n      return id;\n    }\n  }, {\n    key: 'removeEntity',\n    value: function removeEntity(entity) {\n      var _this = this;\n\n      this.entities[entity] = null;\n\n      Object.keys(this.components).forEach(function (component) {\n        return _this.removeComponent(entity, component);\n      });\n    }\n  }, {\n    key: 'setCache',\n    value: function setCache(key, cache) {\n      this.caches[key] = cache;\n    }\n  }, {\n    key: 'getCache',\n    value: function getCache(key) {\n      return this.caches[key];\n    }\n  }, {\n    key: 'addComponent',\n    value: function addComponent(entity, component) {\n      var state = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n      if (!this.components[component]) {\n        this.components[component] = {};\n      }\n\n      this.components[component][entity] = state;\n    }\n  }, {\n    key: 'removeComponent',\n    value: function removeComponent(entity, component) {\n      if (!this.components[component]) {\n        this.components[component] = {};\n      }\n\n      this.components[component][entity] = null;\n    }\n  }, {\n    key: 'getEntitiesWith',\n    value: function getEntitiesWith(components) {\n      var _this2 = this;\n\n      var allEntities = Object.keys(this.entities);\n\n      return allEntities.filter(function (entity) {\n        return components.every(function (component) {\n          return _this2.getComponent(entity, component);\n        });\n      });\n    }\n  }, {\n    key: 'getComponent',\n    value: function getComponent(entity, component) {\n      return this.components[component] && this.components[component][entity];\n    }\n  }, {\n    key: 'debugComponents',\n    value: function debugComponents() {\n      // eslint-disable-next-line no-console\n      console.log(this.components);\n    }\n  }]);\n\n  return Store;\n}();\n\nexports.default = Store;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar v1 = __webpack_require__(6);\nvar v4 = __webpack_require__(8);\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar rng = __webpack_require__(0);\nvar bytesToUuid = __webpack_require__(1);\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\n// random #'s we need to init node and clockseq\nvar _seedBytes = rng();\n\n// Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\nvar _nodeId = [\n  _seedBytes[0] | 0x01,\n  _seedBytes[1], _seedBytes[2], _seedBytes[3], _seedBytes[4], _seedBytes[5]\n];\n\n// Per 4.2.2, randomize (14 bit) clockseq\nvar _clockseq = (_seedBytes[6] << 8 | _seedBytes[7]) & 0x3fff;\n\n// Previous uuid creation time\nvar _lastMSecs = 0, _lastNSecs = 0;\n\n// See https://github.com/broofa/node-uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  var node = options.node || _nodeId;\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports) {\n\nvar g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\n} catch(e) {\n\t// This works if the window reference is available\n\tif(typeof window === \"object\")\n\t\tg = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar rng = __webpack_require__(0);\nvar bytesToUuid = __webpack_require__(1);\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options == 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _render = __webpack_require__(10);\n\nvar _render2 = _interopRequireDefault(_render);\n\nvar _playerControl = __webpack_require__(11);\n\nvar _playerControl2 = _interopRequireDefault(_playerControl);\n\nvar _applyMovement = __webpack_require__(12);\n\nvar _applyMovement2 = _interopRequireDefault(_applyMovement);\n\nvar _evaluateMovement = __webpack_require__(13);\n\nvar _evaluateMovement2 = _interopRequireDefault(_evaluateMovement);\n\nvar _collision = __webpack_require__(14);\n\nvar _collision2 = _interopRequireDefault(_collision);\n\nvar _cacheCollisions = __webpack_require__(15);\n\nvar _cacheCollisions2 = _interopRequireDefault(_cacheCollisions);\n\nvar _bumpAttack = __webpack_require__(16);\n\nvar _bumpAttack2 = _interopRequireDefault(_bumpAttack);\n\nvar _attack = __webpack_require__(17);\n\nvar _attack2 = _interopRequireDefault(_attack);\n\nvar _damage = __webpack_require__(18);\n\nvar _damage2 = _interopRequireDefault(_damage);\n\nvar _death = __webpack_require__(19);\n\nvar _death2 = _interopRequireDefault(_death);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = [(0, _cacheCollisions2.default)(), (0, _playerControl2.default)(), (0, _evaluateMovement2.default)(), (0, _bumpAttack2.default)(), (0, _collision2.default)(), (0, _applyMovement2.default)(), (0, _attack2.default)(), (0, _damage2.default)(), (0, _death2.default)(), (0, _render2.default)()];\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar TILE_SIZE = 20;\n\nvar render = function render() {\n  var canvas = document.getElementById('canvas');\n  var context = canvas.getContext('2d');\n  var layers = [];\n\n  canvas.width = 10 * TILE_SIZE;\n  canvas.height = 10 * TILE_SIZE;\n\n  return function (store) {\n    var entities = store.getEntitiesWith(['tile', 'position']);\n    context.clearRect(0, 0, canvas.width, canvas.height);\n    layers.forEach(function (layer) {\n      layer.getContext('2d').clearRect(0, 0, canvas.width, canvas.height);\n    });\n\n    entities.forEach(function (entity) {\n      var tile = store.getComponent(entity, 'tile');\n      var position = store.getComponent(entity, 'position');\n      var x = position.x * TILE_SIZE;\n      var y = position.y * TILE_SIZE;\n      var _tile$layer = tile.layer,\n          layer = _tile$layer === undefined ? 0 : _tile$layer;\n\n\n      if (!layers[layer]) {\n        layers[layer] = canvas.cloneNode();\n      }\n\n      var ctx = layers[layer].getContext('2d');\n\n      ctx.fillStyle = 'black';\n      ctx.fillRect(x, y, TILE_SIZE, TILE_SIZE);\n\n      ctx.font = '20px monospace';\n      ctx.fillStyle = 'white';\n      ctx.fillText(tile.character, x, y + TILE_SIZE);\n\n      ctx.restore();\n    });\n\n    layers.forEach(function (layer) {\n      context.drawImage(layer, 0, 0);\n    });\n  };\n};\n\nexports.default = render;\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar playerControl = function playerControl() {\n  return function (store, breakLoop) {\n    var intent = store.getCache('playerIntent');\n\n    if (intent && intent.type) {\n      var entities = store.getEntitiesWith(['playerControlled']);\n\n      entities.forEach(function (entity) {\n        switch (intent.type) {\n          case 'move':\n            store.addComponent(entity, 'moveIntent', intent);\n            break;\n          default:\n            breakLoop('Invalid intent from ', entity);\n            break;\n        }\n      });\n    } else {\n      breakLoop('No intent found');\n    }\n\n    store.setCache('playerIntent', null);\n  };\n};\n\nexports.default = playerControl;\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar applyMovement = function applyMovement() {\n  return function (store) {\n    var entities = store.getEntitiesWith(['moveIntent', 'position']);\n\n    entities.forEach(function (entity) {\n      var intent = store.getComponent(entity, 'moveIntent');\n\n      store.addComponent(entity, 'position', intent);\n      store.removeComponent(entity, 'moveIntent');\n    });\n  };\n};\n\nexports.default = applyMovement;\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar evaluateMovement = function evaluateMovement() {\n  return function (store, breakLoop) {\n    var entities = store.getEntitiesWith(['moveIntent', 'position']);\n\n    entities.forEach(function (entity) {\n      var intent = store.getComponent(entity, 'moveIntent');\n\n      var _store$getComponent = store.getComponent(entity, 'position'),\n          x = _store$getComponent.x,\n          y = _store$getComponent.y;\n\n      var result = { x: x, y: y };\n\n      switch (intent.direction) {\n        case 'down':\n          result.y += 1;\n          break;\n        case 'up':\n          result.y -= 1;\n          break;\n        case 'left':\n          result.x -= 1;\n          break;\n        case 'right':\n          result.x += 1;\n          break;\n        default:\n          breakLoop('Invalid movement direction', entity);\n          break;\n      }\n\n      store.addComponent(entity, 'moveIntent', result);\n    });\n  };\n};\n\nexports.default = evaluateMovement;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar collision = function collision() {\n  return function (store) {\n    var entities = store.getEntitiesWith(['moveIntent', 'collides']);\n    var collisionMap = store.getCache('collisions');\n\n    entities.forEach(function (entity) {\n      var _store$getComponent = store.getComponent(entity, 'moveIntent'),\n          x = _store$getComponent.x,\n          y = _store$getComponent.y;\n\n      if (collisionMap[x + ',' + y]) {\n        store.removeComponent(entity, 'moveIntent');\n      }\n    });\n  };\n};\n\nexports.default = collision;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar cacheCollisions = function cacheCollisions() {\n  return function (store) {\n    var entities = store.getEntitiesWith(['collides', 'position']);\n\n    var collisionMap = entities.reduce(function (map, entity) {\n      var _store$getComponent = store.getComponent(entity, 'position'),\n          x = _store$getComponent.x,\n          y = _store$getComponent.y;\n\n      return _extends({}, map, _defineProperty({}, x + ',' + y, entity));\n    }, {});\n\n    store.setCache('collisions', collisionMap);\n  };\n};\n\nexports.default = cacheCollisions;\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar bumpAttack = function bumpAttack() {\n  return function (store) {\n    var entities = store.getEntitiesWith(['moveIntent', 'collides', 'canAttack']);\n    var collisionMap = store.getCache('collisions');\n\n    entities.forEach(function (entity) {\n      var _store$getComponent = store.getComponent(entity, 'moveIntent'),\n          x = _store$getComponent.x,\n          y = _store$getComponent.y;\n\n      var collidingEntity = collisionMap[x + ',' + y];\n\n      if (collidingEntity && store.getComponent(collidingEntity, 'health')) {\n        store.removeComponent(entity, 'moveIntent');\n        store.addComponent(entity, 'attackIntent', { target: collidingEntity });\n      }\n    });\n  };\n};\n\nexports.default = bumpAttack;\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar attack = function attack() {\n  return function (store) {\n    var entities = store.getEntitiesWith(['attackIntent']);\n\n    entities.forEach(function (entity) {\n      var _store$getComponent = store.getComponent(entity, 'attackIntent'),\n          target = _store$getComponent.target;\n\n      store.addComponent(target, 'receiveDamage', 1);\n      store.removeComponent(entity, 'attackIntent');\n    });\n  };\n};\n\nexports.default = attack;\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar receiveDamage = function receiveDamage() {\n  return function (store) {\n    var entities = store.getEntitiesWith(['receiveDamage']);\n\n    entities.forEach(function (entity) {\n      var damage = store.getComponent(entity, 'receiveDamage');\n\n      var _store$getComponent = store.getComponent(entity, 'health'),\n          value = _store$getComponent.value;\n\n      store.addComponent(entity, 'health', { value: value - damage });\n      store.removeComponent(entity, 'receiveDamage');\n    });\n  };\n};\n\nexports.default = receiveDamage;\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _assemblages = __webpack_require__(2);\n\nvar death = function death() {\n  return function (store) {\n    var entities = store.getEntitiesWith(['health']);\n\n    entities.forEach(function (entity) {\n      var health = store.getComponent(entity, 'health');\n      var position = store.getComponent(entity, 'position');\n\n      if (health && health.value < 0) {\n        store.removeEntity(entity);\n\n        if (position) {\n          (0, _assemblages.createGravestone)(store, position);\n        }\n      }\n    });\n  };\n};\n\nexports.default = death;\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar runLoop = function runLoop(store, systems) {\n  var debug = store.getCache('debug');\n  var loop = true;\n  var iteration = 0;\n  var breakLoop = function breakLoop(message) {\n    if (debug) {\n      // eslint-disable-next-line no-console\n      console.warn(message);\n    }\n    loop = false;\n  };\n\n  while (loop) {\n    iteration += 1;\n\n    if (iteration > 10) {\n      breakLoop('Iteration limit reached');\n    }\n\n    systems.forEach(function (system) {\n      return system(store, breakLoop);\n    });\n  }\n};\n\nexports.default = runLoop;\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar EVENT = 'keydown';\n\nvar createInputHandler = function createInputHandler(callback) {\n  var handler = function handler(event) {\n    if (event && !event.repeat) {\n      switch (event.code) {\n        case 'KeyW':\n        case 'ArrowUp':\n          callback('up');\n          break;\n        case 'KeyS':\n        case 'ArrowDown':\n          callback('down');\n          break;\n        case 'KeyA':\n        case 'ArrowLeft':\n          callback('left');\n          break;\n        case 'KeyD':\n        case 'ArrowRight':\n          callback('right');\n          break;\n        default:\n          break;\n      }\n    }\n  };\n\n  window.addEventListener(EVENT, handler);\n\n  return function () {\n    return window.removeEventListener(EVENT, handler);\n  };\n};\n\nexports.default = createInputHandler;\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _ = __webpack_require__(2);\n\nvar MAP = ['          ', ' ######## ', '##......# ', '#...@...# ', '#.......# ', '##....K.##', ' #.......#', ' #########'];\n\nvar buildMap = function buildMap(store) {\n  return MAP.forEach(function (row, y) {\n    row.split('').forEach(function (cell, x) {\n      switch (cell) {\n        case '@':\n          (0, _.createPlayer)(store, { x: x, y: y });\n          (0, _.createFloor)(store, { x: x, y: y });\n          break;\n        case '#':\n          (0, _.createWall)(store, { x: x, y: y });\n          break;\n        case '.':\n          (0, _.createFloor)(store, { x: x, y: y });\n          break;\n        case 'K':\n          (0, _.createEnemy)(store, { x: x, y: y });\n          (0, _.createFloor)(store, { x: x, y: y });\n          break;\n        default:\n          break;\n      }\n    });\n  });\n};\n\nexports.default = buildMap;\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar KEYS = {\n  up: 'ArrowUp',\n  down: 'ArrowDown',\n  left: 'ArrowLeft',\n  right: 'ArrowRight'\n};\n\nvar dispatchKey = function dispatchKey(key) {\n  return function () {\n    var e = new Event('keydown');\n    e.code = key;\n    window.dispatchEvent(e);\n  };\n};\n\nvar buildControls = function buildControls() {\n  Object.keys(KEYS).forEach(function (key) {\n    var button = document.getElementById(key + '-button');\n\n    button.addEventListener('click', dispatchKey(KEYS[key]));\n  });\n};\n\nexports.default = buildControls;\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// main.d15a88ea.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d15a88eab687b84e4404","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\nvar rng;\n\nvar crypto = global.crypto || global.msCrypto; // for IE 11\nif (crypto && crypto.getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n  rng = function whatwgRNG() {\n    crypto.getRandomValues(rnds8);\n    return rnds8;\n  };\n}\n\nif (!rng) {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n  rng = function() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n\nmodule.exports = rng;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/uuid/lib/rng-browser.js\n// module id = 0\n// module chunks = 0","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  return bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]];\n}\n\nmodule.exports = bytesToUuid;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/uuid/lib/bytesToUuid.js\n// module id = 1\n// module chunks = 0","const createPlayer = (store, position) => {\n  const entity = store.createEntity()\n\n  store.addComponent(entity, 'position', position)\n  store.addComponent(entity, 'tile', { character: '@', layer: 2 })\n  store.addComponent(entity, 'playerControlled')\n  store.addComponent(entity, 'collides')\n  store.addComponent(entity, 'canAttack')\n\n  return entity\n}\n\nconst createEnemy = (store, position) => {\n  const entity = store.createEntity()\n\n  store.addComponent(entity, 'position', position)\n  store.addComponent(entity, 'tile', { character: 'K', layer: 2 })\n  store.addComponent(entity, 'collides')\n  store.addComponent(entity, 'health', { value: 3 })\n\n  return entity\n}\n\nconst createWall = (store, position) => {\n  const entity = store.createEntity()\n\n  store.addComponent(entity, 'position', position)\n  store.addComponent(entity, 'tile', { character: '#' })\n  store.addComponent(entity, 'collides')\n\n  return entity\n}\n\nconst createFloor = (store, position) => {\n  const entity = store.createEntity()\n\n  store.addComponent(entity, 'position', position)\n  store.addComponent(entity, 'tile', { character: '.' })\n\n  return entity\n}\n\nconst createGravestone = (store, position) => {\n  const entity = store.createEntity()\n\n  store.addComponent(entity, 'position', position)\n  store.addComponent(entity, 'tile', { character: '✝', layer: 1 })\n\n  return entity\n}\n\nexport {\n  createPlayer,\n  createEnemy,\n  createWall,\n  createFloor,\n  createGravestone,\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/assemblages/index.js","import Store from './utils/store'\nimport systems from './systems'\nimport runLoop from './utils/loop'\nimport createInputHandler from './utils/inputHandler'\nimport buildMap from './assemblages/map'\nimport buildOnScreenControls from './utils/onScreenControls'\n\nimport './index.css'\n\nconst store = new Store()\n\ncreateInputHandler((direction) => {\n  store.setCache('playerIntent', { type: 'move', direction })\n  runLoop(store, systems)\n})\n\nbuildMap(store)\nrunLoop(store, systems)\n\nbuildOnScreenControls()\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import { v4 as uuid } from 'uuid'\n\nclass Store {\n  constructor() {\n    this.entities = {}\n    this.components = {}\n    this.caches = {}\n  }\n\n  createEntity() {\n    const id = uuid()\n    this.entities[id] = true\n\n    return id\n  }\n\n  removeEntity(entity) {\n    this.entities[entity] = null\n\n    Object.keys(this.components).forEach(component => this.removeComponent(entity, component))\n  }\n\n  setCache(key, cache) {\n    this.caches[key] = cache\n  }\n\n  getCache(key) {\n    return this.caches[key]\n  }\n\n  addComponent(entity, component, state = true) {\n    if (!this.components[component]) {\n      this.components[component] = {}\n    }\n\n    this.components[component][entity] = state\n  }\n\n  removeComponent(entity, component) {\n    if (!this.components[component]) {\n      this.components[component] = {}\n    }\n\n    this.components[component][entity] = null\n  }\n\n  getEntitiesWith(components) {\n    const allEntities = Object.keys(this.entities)\n\n    return allEntities.filter(entity => (\n      components.every(component => this.getComponent(entity, component))\n    ))\n  }\n\n  getComponent(entity, component) {\n    return this.components[component] && this.components[component][entity]\n  }\n\n  debugComponents() {\n    // eslint-disable-next-line no-console\n    console.log(this.components)\n  }\n}\n\nexport default Store\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/store.js","var v1 = require('./v1');\nvar v4 = require('./v4');\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/uuid/index.js\n// module id = 5\n// module chunks = 0","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\n// random #'s we need to init node and clockseq\nvar _seedBytes = rng();\n\n// Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\nvar _nodeId = [\n  _seedBytes[0] | 0x01,\n  _seedBytes[1], _seedBytes[2], _seedBytes[3], _seedBytes[4], _seedBytes[5]\n];\n\n// Per 4.2.2, randomize (14 bit) clockseq\nvar _clockseq = (_seedBytes[6] << 8 | _seedBytes[7]) & 0x3fff;\n\n// Previous uuid creation time\nvar _lastMSecs = 0, _lastNSecs = 0;\n\n// See https://github.com/broofa/node-uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  var node = options.node || _nodeId;\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/uuid/v1.js\n// module id = 6\n// module chunks = 0","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\n} catch(e) {\n\t// This works if the window reference is available\n\tif(typeof window === \"object\")\n\t\tg = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 7\n// module chunks = 0","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options == 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/uuid/v4.js\n// module id = 8\n// module chunks = 0","import render from './render'\nimport playerControl from './playerControl'\nimport applyMovement from './applyMovement'\nimport evaluateMovement from './evaluateMovement'\nimport collision from './collision'\nimport cacheCollisions from './cacheCollisions'\nimport bumpAttack from './bumpAttack'\nimport attack from './attack'\nimport damage from './damage'\nimport death from './death'\n\nexport default [\n  cacheCollisions(),\n  playerControl(),\n  evaluateMovement(),\n  bumpAttack(),\n  collision(),\n  applyMovement(),\n  attack(),\n  damage(),\n  death(),\n  render(),\n]\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/index.js","const TILE_SIZE = 20\n\nconst render = () => {\n  const canvas = document.getElementById('canvas')\n  const context = canvas.getContext('2d')\n  const layers = []\n\n  canvas.width = 10 * TILE_SIZE\n  canvas.height = 10 * TILE_SIZE\n\n  return (store) => {\n    const entities = store.getEntitiesWith(['tile', 'position'])\n    context.clearRect(0, 0, canvas.width, canvas.height)\n    layers.forEach((layer) => {\n      layer.getContext('2d').clearRect(0, 0, canvas.width, canvas.height)\n    })\n\n    entities.forEach((entity) => {\n      const tile = store.getComponent(entity, 'tile')\n      const position = store.getComponent(entity, 'position')\n      const x = position.x * TILE_SIZE\n      const y = position.y * TILE_SIZE\n      const { layer = 0 } = tile\n\n      if (!layers[layer]) {\n        layers[layer] = canvas.cloneNode()\n      }\n\n      const ctx = layers[layer].getContext('2d')\n\n      ctx.fillStyle = 'black'\n      ctx.fillRect(x, y, TILE_SIZE, TILE_SIZE)\n\n      ctx.font = '20px monospace'\n      ctx.fillStyle = 'white'\n      ctx.fillText(tile.character, x, y + TILE_SIZE)\n\n      ctx.restore()\n    })\n\n    layers.forEach((layer) => {\n      context.drawImage(layer, 0, 0)\n    })\n  }\n}\n\nexport default render\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/render.js","const playerControl = () => (store, breakLoop) => {\n  const intent = store.getCache('playerIntent')\n\n  if (intent && intent.type) {\n    const entities = store.getEntitiesWith(['playerControlled'])\n\n    entities.forEach((entity) => {\n      switch (intent.type) {\n        case 'move':\n          store.addComponent(entity, 'moveIntent', intent)\n          break\n        default:\n          breakLoop('Invalid intent from ', entity)\n          break\n      }\n    })\n  } else {\n    breakLoop('No intent found')\n  }\n\n  store.setCache('playerIntent', null)\n}\n\nexport default playerControl\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/playerControl.js","const applyMovement = () => (store) => {\n  const entities = store.getEntitiesWith(['moveIntent', 'position'])\n\n  entities.forEach((entity) => {\n    const intent = store.getComponent(entity, 'moveIntent')\n\n    store.addComponent(entity, 'position', intent)\n    store.removeComponent(entity, 'moveIntent')\n  })\n}\n\nexport default applyMovement\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/applyMovement.js","const evaluateMovement = () => (store, breakLoop) => {\n  const entities = store.getEntitiesWith(['moveIntent', 'position'])\n\n  entities.forEach((entity) => {\n    const intent = store.getComponent(entity, 'moveIntent')\n    const { x, y } = store.getComponent(entity, 'position')\n    const result = { x, y }\n\n    switch (intent.direction) {\n      case 'down':\n        result.y += 1\n        break\n      case 'up':\n        result.y -= 1\n        break\n      case 'left':\n        result.x -= 1\n        break\n      case 'right':\n        result.x += 1\n        break\n      default:\n        breakLoop('Invalid movement direction', entity)\n        break\n    }\n\n    store.addComponent(entity, 'moveIntent', result)\n  })\n}\n\nexport default evaluateMovement\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/evaluateMovement.js","const collision = () => (store) => {\n  const entities = store.getEntitiesWith(['moveIntent', 'collides'])\n  const collisionMap = store.getCache('collisions')\n\n  entities.forEach((entity) => {\n    const { x, y } = store.getComponent(entity, 'moveIntent')\n\n    if (collisionMap[`${x},${y}`]) {\n      store.removeComponent(entity, 'moveIntent')\n    }\n  })\n}\n\nexport default collision\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/collision.js","const cacheCollisions = () => (store) => {\n  const entities = store.getEntitiesWith(['collides', 'position'])\n\n  const collisionMap = entities.reduce((map, entity) => {\n    const { x, y } = store.getComponent(entity, 'position')\n\n    return {\n      ...map,\n      [`${x},${y}`]: entity,\n    }\n  }, {})\n\n  store.setCache('collisions', collisionMap)\n}\n\nexport default cacheCollisions\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/cacheCollisions.js","const bumpAttack = () => (store) => {\n  const entities = store.getEntitiesWith(['moveIntent', 'collides', 'canAttack'])\n  const collisionMap = store.getCache('collisions')\n\n  entities.forEach((entity) => {\n    const { x, y } = store.getComponent(entity, 'moveIntent')\n    const collidingEntity = collisionMap[`${x},${y}`]\n\n    if (collidingEntity && store.getComponent(collidingEntity, 'health')) {\n      store.removeComponent(entity, 'moveIntent')\n      store.addComponent(entity, 'attackIntent', { target: collidingEntity })\n    }\n  })\n}\n\nexport default bumpAttack\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/bumpAttack.js","const attack = () => (store) => {\n  const entities = store.getEntitiesWith(['attackIntent'])\n\n  entities.forEach((entity) => {\n    const { target } = store.getComponent(entity, 'attackIntent')\n\n    store.addComponent(target, 'receiveDamage', 1)\n    store.removeComponent(entity, 'attackIntent')\n  })\n}\n\nexport default attack\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/attack.js","const receiveDamage = () => (store) => {\n  const entities = store.getEntitiesWith(['receiveDamage'])\n\n  entities.forEach((entity) => {\n    const damage = store.getComponent(entity, 'receiveDamage')\n    const { value } = store.getComponent(entity, 'health')\n\n    store.addComponent(entity, 'health', { value: value - damage })\n    store.removeComponent(entity, 'receiveDamage')\n  })\n}\n\nexport default receiveDamage\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/damage.js","import { createGravestone } from '../assemblages'\n\nconst death = () => (store) => {\n  const entities = store.getEntitiesWith(['health'])\n\n  entities.forEach((entity) => {\n    const health = store.getComponent(entity, 'health')\n    const position = store.getComponent(entity, 'position')\n\n    if (health && health.value < 0) {\n      store.removeEntity(entity)\n\n      if (position) {\n        createGravestone(store, position)\n      }\n    }\n  })\n}\n\nexport default death\n\n\n\n// WEBPACK FOOTER //\n// ./src/systems/death.js","const runLoop = (store, systems) => {\n  const debug = store.getCache('debug')\n  let loop = true\n  let iteration = 0\n  const breakLoop = (message) => {\n    if (debug) {\n      // eslint-disable-next-line no-console\n      console.warn(message)\n    }\n    loop = false\n  }\n\n  while (loop) {\n    iteration += 1\n\n    if (iteration > 10) {\n      breakLoop('Iteration limit reached')\n    }\n\n    systems.forEach(system => system(store, breakLoop))\n  }\n}\n\nexport default runLoop\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/loop.js","const EVENT = 'keydown'\n\nconst createInputHandler = (callback) => {\n  const handler = (event) => {\n    if (event && !event.repeat) {\n      switch (event.code) {\n        case 'KeyW':\n        case 'ArrowUp':\n          callback('up')\n          break\n        case 'KeyS':\n        case 'ArrowDown':\n          callback('down')\n          break\n        case 'KeyA':\n        case 'ArrowLeft':\n          callback('left')\n          break\n        case 'KeyD':\n        case 'ArrowRight':\n          callback('right')\n          break\n        default:\n          break\n      }\n    }\n  }\n\n  window.addEventListener(EVENT, handler)\n\n  return () => window.removeEventListener(EVENT, handler)\n}\n\nexport default createInputHandler\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/inputHandler.js","import {\n  createPlayer,\n  createEnemy,\n  createWall,\n  createFloor,\n} from './'\n\nconst MAP = [\n  '          ',\n  ' ######## ',\n  '##......# ',\n  '#...@...# ',\n  '#.......# ',\n  '##....K.##',\n  ' #.......#',\n  ' #########',\n]\n\nconst buildMap = store => MAP.forEach((row, y) => {\n  row.split('').forEach((cell, x) => {\n    switch (cell) {\n      case '@':\n        createPlayer(store, { x, y })\n        createFloor(store, { x, y })\n        break\n      case '#':\n        createWall(store, { x, y })\n        break\n      case '.':\n        createFloor(store, { x, y })\n        break\n      case 'K':\n        createEnemy(store, { x, y })\n        createFloor(store, { x, y })\n        break\n      default:\n        break\n    }\n  })\n})\n\nexport default buildMap\n\n\n\n// WEBPACK FOOTER //\n// ./src/assemblages/map.js","const KEYS = {\n  up: 'ArrowUp',\n  down: 'ArrowDown',\n  left: 'ArrowLeft',\n  right: 'ArrowRight',\n}\n\nconst dispatchKey = key => () => {\n  const e = new Event('keydown')\n  e.code = key\n  window.dispatchEvent(e)\n}\n\nconst buildControls = () => {\n  Object.keys(KEYS).forEach((key) => {\n    const button = document.getElementById(`${key}-button`)\n\n    button.addEventListener('click', dispatchKey(KEYS[key]))\n  })\n}\n\nexport default buildControls\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/onScreenControls.js"],"sourceRoot":""}